1
00:00:00,000 --> 00:00:03,194
サブグループにまたがる
モデル予測の評価指標を

2
00:00:03,194 --> 00:00:05,314
計算する方法を学びましたので

3
00:00:05,314 --> 00:00:08,360
その指標に基づいて構築する
手法を見ていきます

4
00:00:08,360 --> 00:00:11,660
これでサブグループにまたがる
より良い成果が得られます

5
00:00:11,660 --> 00:00:14,880
ご紹介する手法は
いわゆる「機会の均等化」です

6
00:00:14,880 --> 00:00:16,520
次のようなものです

7
00:00:16,520 --> 00:00:20,340
全ユーザーに対して機能するよう
設計されたモデルがあるとします

8
00:00:20,340 --> 00:00:23,402
出身地に関わらず
あらゆるユーザーを処理します

9
00:00:23,402 --> 00:00:24,605
理想を言うと

10
00:00:24,605 --> 00:00:28,595
望ましい出力に入る資格がある各ユーザーは

11
00:00:28,595 --> 00:00:34,790
実際に正しく分類される機会が
全ユーザーと均等でなければなりません

12
00:00:34,790 --> 00:00:37,415
たとえば銀行のために作業する開発者が

13
00:00:37,425 --> 00:00:40,705
ローンの承認/却下を決定するMLモデルを

14
00:00:40,705 --> 00:00:42,425
構築するとします

15
00:00:42,425 --> 00:00:45,490
この場合 機会の均等化とは
どういう意味ですか?

16
00:00:45,490 --> 00:00:48,765
理想的には ローンの資格がある
すべてのユーザーと

17
00:00:48,765 --> 00:00:52,019
「承認」に正しく分類される
全ユーザーを比べて

18
00:00:52,019 --> 00:00:53,989
機会が均等であるべきです

19
00:00:53,989 --> 00:00:57,295
言い換えると ローンの資格がある人の機会は

20
00:00:57,295 --> 00:01:01,155
どのサブグループに属するかに関係なく
均等でなければなりません

21
00:01:01,155 --> 00:01:04,849
つまり その人の全情報を同じに保ったまま

22
00:01:04,849 --> 00:01:08,325
その人をあるグループから
別のグループに移した場合

23
00:01:08,325 --> 00:01:11,640
ローンの資格を得る機会が
変化してはならないのです

24
00:01:11,640 --> 00:01:15,405
この手法をMLシステムに
組み込むのはなぜですか?

25
00:01:15,405 --> 00:01:19,095
この手法がきっかけで
モデルをもっと注意深く調べ

26
00:01:19,095 --> 00:01:22,140
懸念事項が見つかる可能性があるからです

27
00:01:22,140 --> 00:01:24,880
改善する分野を特定できたら

28
00:01:24,880 --> 00:01:26,975
必要な調整を加えて

29
00:01:26,975 --> 00:01:30,915
正確さと公平さの間の
トレードオフを改善していきます

30
00:01:30,915 --> 00:01:34,320
そうすればMLモデルを
より包括的にすることができます

31
00:01:34,320 --> 00:01:37,560
簡単な分類を使ってこれを説明しましょう

32
00:01:37,560 --> 00:01:39,524
実際のモデルではありません

33
00:01:39,524 --> 00:01:42,980
概念を説明するための架空の例です

34
00:01:42,980 --> 00:01:44,670
このモデルの目的は

35
00:01:44,670 --> 00:01:47,610
誰がローンを返済するか高い精度で予測し

36
00:01:47,610 --> 00:01:52,650
このモデルを使って銀行がローン申込者の
承認/却下を決めることです

37
00:01:53,755 --> 00:01:55,850
ここに示す図で

38
00:01:55,850 --> 00:01:58,985
濃い色の点はローンを払う人

39
00:01:58,985 --> 00:02:01,735
薄い色の点は払わない人です

40
00:02:01,735 --> 00:02:04,585
上の行の数字は信用度スコアです

41
00:02:04,585 --> 00:02:07,165
単純化のために0～100にしました

42
00:02:07,165 --> 00:02:11,425
スコアが高ければ
ローンを返済する可能性が高いです

43
00:02:11,425 --> 00:02:14,350
理想的な世界では左の例のように

44
00:02:14,350 --> 00:02:19,125
カテゴリをはっきり分ける統計を使えます

45
00:02:19,125 --> 00:02:22,315
残念ながら一般的な状況では

46
00:02:22,315 --> 00:02:25,515
右の例のようにグループが重なり合います

47
00:02:25,515 --> 00:02:28,150
信用度スコアのような1つの統計値を

48
00:02:28,150 --> 00:02:30,840
さまざまな変数の代わりに使えます

49
00:02:30,840 --> 00:02:32,675
後で具体的にご紹介しますが

50
00:02:32,675 --> 00:02:35,415
ほとんどの機械学習モデルは確率を返します

51
00:02:35,415 --> 00:02:38,835
それで信用度スコアを
その確率の代わりに使えます

52
00:02:38,835 --> 00:02:43,815
信用度スコアのような
MLモデルから得られる確率は

53
00:02:43,815 --> 00:02:46,300
収入や借入金支払履歴などの

54
00:02:46,300 --> 00:02:49,010
多くの要因を考慮に入れます

55
00:02:49,010 --> 00:02:52,150
この数値は
ある人が完済する/債務不履行になる

56
00:02:52,150 --> 00:02:54,600
可能性を表すかもしれませんが

57
00:02:54,600 --> 00:02:56,435
表さないかもしれません

58
00:02:56,450 --> 00:02:59,670
そのため しきい値の設定が必要になります

59
00:02:59,670 --> 00:03:02,185
基本的に 特定の分割点を決めて

60
00:03:02,185 --> 00:03:05,685
信用度スコアがそれより低い人の
ローンを却下します

61
00:03:05,685 --> 00:03:08,260
分割点より高い人にはローンを許可します

62
00:03:08,260 --> 00:03:09,760
この図でわかるように

63
00:03:09,760 --> 00:03:12,490
しきい値の選び方にはトレードオフがあります

64
00:03:12,490 --> 00:03:15,950
低すぎると 許可されたローンの
多くが不履行になり

65
00:03:15,950 --> 00:03:19,910
高すぎると ローンを受けられるはずの
多くの人が拒否されます

66
00:03:19,910 --> 00:03:21,631
最善のしきい値はどこですか

67
00:03:21,631 --> 00:03:25,290
使用するしきい値は
目的や意図によって変わります

68
00:03:25,290 --> 00:03:27,225
目的によってはこの図のように

69
00:03:27,225 --> 00:03:29,865
正しい判断の数が最大になるようにします

70
00:03:29,865 --> 00:03:32,100
左側の濃い青の点は

71
00:03:32,100 --> 00:03:35,400
承認され返済されたローンを表しています

72
00:03:35,400 --> 00:03:37,075
薄いグレーの点は

73
00:03:37,075 --> 00:03:40,325
不履行になりそうなので
却下されたローンを表します

74
00:03:40,325 --> 00:03:43,830
このすべての点は 正しい予測を表します

75
00:03:43,830 --> 00:03:49,885
一方 右側の水色の点は
承認されたが不履行になったローンです

76
00:03:49,885 --> 00:03:52,045
濃いグレーの点は

77
00:03:52,045 --> 00:03:56,175
実際は返済できたはずなのに
ローンを却下された人です

78
00:03:56,175 --> 00:03:58,650
これらの点は 間違った予測を表します

79
00:03:58,650 --> 00:04:02,340
中には財政的に負担が大きくなるような決定もあります

80
00:04:02,340 --> 00:04:04,550
たとえば ローンにはカテゴリがあり

81
00:04:04,550 --> 00:04:09,180
15年の住宅ローンは他のローンより
高収益な可能性があります

82
00:04:09,180 --> 00:04:12,650
それで すべての決定を
同じように扱うべきではないでしょう

83
00:04:12,650 --> 00:04:15,440
財務面で別の目標として

84
00:04:15,440 --> 00:04:17,980
正しい決定の数を最大にするよりも

85
00:04:17,980 --> 00:04:21,200
全体の利益を最大化することが考えられます

86
00:04:21,200 --> 00:04:25,340
この下の図は 仮定利益を表しています

87
00:04:25,340 --> 00:04:29,900
各ローンに関連する
利益を推計して得られました

88
00:04:29,900 --> 00:04:31,355
ここで質問が生じます

89
00:04:31,355 --> 00:04:33,825
利益が最大になるしきい値はどこですか

90
00:04:33,825 --> 00:04:37,410
そのしきい値は 最も正しい決定の
しきい値と一致しますか

91
00:04:37,410 --> 00:04:41,790
2グループ間で信用度スコアの
分散が異なるような場合

92
00:04:41,790 --> 00:04:44,980
この質問に答えるのは困難です

93
00:04:44,980 --> 00:04:47,375
ここで機会の均等化を使えます

94
00:04:47,375 --> 00:04:51,140
機会の均等化の公式は こんな感じです

95
00:04:51,140 --> 00:04:55,105
Aは予測される属性を表すとします

96
00:04:55,105 --> 00:04:57,470
単純化のためにAはバイナリ値で

97
00:04:57,470 --> 00:05:00,710
ある保護グループのメンバーシップを
表すものとします

98
00:05:00,710 --> 00:05:02,635
私は弁護士ではないので

99
00:05:02,635 --> 00:05:06,045
皆様の公的エリアの
保護グループについて知りません

100
00:05:06,045 --> 00:05:08,485
何を保護するか（しないか）については

101
00:05:08,485 --> 00:05:10,455
会社の法務部門にご相談ください

102
00:05:10,455 --> 00:05:12,515
一例として米国では

103
00:05:12,515 --> 00:05:17,260
年齢に基づいて従業員を差別しないよう
連邦法で保護されています

104
00:05:17,260 --> 00:05:20,005
それで 構築しているアプリによっては

105
00:05:20,005 --> 00:05:22,655
年齢が保護グループになるでしょう

106
00:05:22,655 --> 00:05:26,060
さらにYというバイナリ出力があるとします

107
00:05:26,060 --> 00:05:30,200
Y = 1は望ましい出力だと解釈します

108
00:05:30,200 --> 00:05:33,135
この例ではローンの承認を表します

109
00:05:33,135 --> 00:05:36,625
この例のYを実検証データ
またはラベルと見なしますが

110
00:05:36,625 --> 00:05:38,835
Yのモデルを構築しているので

111
00:05:38,835 --> 00:05:42,250
予測変数「Y^」も必要です

112
00:05:42,250 --> 00:05:44,215
この例では予測機能は常に

113
00:05:44,215 --> 00:05:47,545
0～1のスコアを使って定義されるしきい値です

114
00:05:47,545 --> 00:05:50,470
予測変数はAに依存するしきい値を使用し

115
00:05:50,470 --> 00:05:53,500
別のグループには別のしきい値を使えます

116
00:05:53,500 --> 00:05:54,925
要点はこうです

117
00:05:54,925 --> 00:05:59,065
Aの中で 正の出力の資格がある人は

118
00:05:59,065 --> 00:06:04,565
A以外に属する、正に分類される人と
同じ機会が与えられる必要があります

119
00:06:04,565 --> 00:06:10,380
もっと定式的に言うと 両方のグループで
真陽性率が等しいことです

120
00:06:10,380 --> 00:06:14,240
これが機会の均等化の背後にある原理です