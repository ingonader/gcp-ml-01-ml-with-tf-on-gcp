サブグループにまたがる
モデル予測の評価指標を 計算する方法を学びましたので その指標に基づいて構築する
手法を見ていきます これでサブグループにまたがる
より良い成果が得られます ご紹介する手法は
いわゆる「機会の均等化」です 次のようなものです 全ユーザーに対して機能するよう
設計されたモデルがあるとします 出身地に関わらず
あらゆるユーザーを処理します 理想を言うと 望ましい出力に入る資格がある各ユーザーは 実際に正しく分類される機会が
全ユーザーと均等でなければなりません たとえば銀行のために作業する開発者が ローンの承認/却下を決定するMLモデルを 構築するとします この場合 機会の均等化とは
どういう意味ですか? 理想的には ローンの資格がある
すべてのユーザーと 「承認」に正しく分類される
全ユーザーを比べて 機会が均等であるべきです 言い換えると ローンの資格がある人の機会は どのサブグループに属するかに関係なく
均等でなければなりません つまり その人の全情報を同じに保ったまま その人をあるグループから
別のグループに移した場合 ローンの資格を得る機会が
変化してはならないのです この手法をMLシステムに
組み込むのはなぜですか? この手法がきっかけで
モデルをもっと注意深く調べ 懸念事項が見つかる可能性があるからです 改善する分野を特定できたら 必要な調整を加えて 正確さと公平さの間の
トレードオフを改善していきます そうすればMLモデルを
より包括的にすることができます 簡単な分類を使ってこれを説明しましょう 実際のモデルではありません 概念を説明するための架空の例です このモデルの目的は 誰がローンを返済するか高い精度で予測し このモデルを使って銀行がローン申込者の
承認/却下を決めることです ここに示す図で 濃い色の点はローンを払う人 薄い色の点は払わない人です 上の行の数字は信用度スコアです 単純化のために0～100にしました スコアが高ければ
ローンを返済する可能性が高いです 理想的な世界では左の例のように カテゴリをはっきり分ける統計を使えます 残念ながら一般的な状況では 右の例のようにグループが重なり合います 信用度スコアのような1つの統計値を さまざまな変数の代わりに使えます 後で具体的にご紹介しますが ほとんどの機械学習モデルは確率を返します それで信用度スコアを
その確率の代わりに使えます 信用度スコアのような
MLモデルから得られる確率は 収入や借入金支払履歴などの 多くの要因を考慮に入れます この数値は
ある人が完済する/債務不履行になる 可能性を表すかもしれませんが 表さないかもしれません そのため しきい値の設定が必要になります 基本的に 特定の分割点を決めて 信用度スコアがそれより低い人の
ローンを却下します 分割点より高い人にはローンを許可します この図でわかるように しきい値の選び方にはトレードオフがあります 低すぎると 許可されたローンの
多くが不履行になり 高すぎると ローンを受けられるはずの
多くの人が拒否されます 最善のしきい値はどこですか 使用するしきい値は
目的や意図によって変わります 目的によってはこの図のように 正しい判断の数が最大になるようにします 左側の濃い青の点は 承認され返済されたローンを表しています 薄いグレーの点は 不履行になりそうなので
却下されたローンを表します このすべての点は 正しい予測を表します 一方 右側の水色の点は
承認されたが不履行になったローンです 濃いグレーの点は 実際は返済できたはずなのに
ローンを却下された人です これらの点は 間違った予測を表します 中には財政的に負担が大きくなるような決定もあります たとえば ローンにはカテゴリがあり 15年の住宅ローンは他のローンより
高収益な可能性があります それで すべての決定を
同じように扱うべきではないでしょう 財務面で別の目標として 正しい決定の数を最大にするよりも 全体の利益を最大化することが考えられます この下の図は 仮定利益を表しています 各ローンに関連する
利益を推計して得られました ここで質問が生じます 利益が最大になるしきい値はどこですか そのしきい値は 最も正しい決定の
しきい値と一致しますか 2グループ間で信用度スコアの
分散が異なるような場合 この質問に答えるのは困難です ここで機会の均等化を使えます 機会の均等化の公式は こんな感じです Aは予測される属性を表すとします 単純化のためにAはバイナリ値で ある保護グループのメンバーシップを
表すものとします 私は弁護士ではないので 皆様の公的エリアの
保護グループについて知りません 何を保護するか（しないか）については 会社の法務部門にご相談ください 一例として米国では 年齢に基づいて従業員を差別しないよう
連邦法で保護されています それで 構築しているアプリによっては 年齢が保護グループになるでしょう さらにYというバイナリ出力があるとします Y = 1は望ましい出力だと解釈します この例ではローンの承認を表します この例のYを実検証データ
またはラベルと見なしますが Yのモデルを構築しているので 予測変数「Y^」も必要です この例では予測機能は常に 0～1のスコアを使って定義されるしきい値です 予測変数はAに依存するしきい値を使用し 別のグループには別のしきい値を使えます 要点はこうです Aの中で 正の出力の資格がある人は A以外に属する、正に分類される人と
同じ機会が与えられる必要があります もっと定式的に言うと 両方のグループで
真陽性率が等しいことです これが機会の均等化の背後にある原理です