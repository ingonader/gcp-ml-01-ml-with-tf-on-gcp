評価指標を使ってMLモデルを
より包括的にする方法を すでに見ました でもモデルから最善の結果を得るには
データを本当に理解する必要があります しばしば課題となるのは データセットに何億もの
データポイントが含まれ それぞれに数百、数千もの特性がある場合です そうなると直感的にデータセット全体を
理解するのはほぼ不可能です 鍵となるのは 可視化を利用して 巨大なデータセットの微妙な意味合いや
分析情報を明らかにすることです このセクションでは Facetsというオープンソースの
データ可視化ツールを見ていきます FacetsはGoogleで開発され 機械学習モデルを
より包括的にする手段の1つです Facetsは2つの部分
OverviewとDiveで構成されます このスライドはFacets Overviewの
スクリーンショットです データセットの複数の特性にまたがる
値の分散が 短時間で自動的にわかります このスライドの例は
UCI人口調査データから得られました データは1994年国勢調査
データベースから抽出され 米国の人口に関する
匿名化データが入っています このデータセットには 人口動向や雇用に関連する
データが含まれています 年齢や給与などです 調査委員会によってまとめられた
このデータセットは ある人の年収が$5万以上かどうか 予測するためのタスクによく使われます トレーニングセットとテストセットなど 複数のデータセットを
同じ可視化で比較できます Facetsでは 機械学習を妨げる一般的な
データの問題が前面に出てきます たとえば 予想に反した特性値がある 高い割合で欠落した値がある 分散に偏りがある データセット間で分散が非対称
といった問題です 前のスライドと同じスクリーンショットですが UCI国勢調査データセットの
2つの数値特性値が示されています つまり資本利得と資本損失です 特性値は 不均一性を基準に並べ替えられ 最も不均一な分散の特性が最も上になります 赤い数値は問題の可能性がある個所を示します この場合は 高い割合で
値がゼロに設定される数値特性値です 右側のヒストグラムを見ると 青のトレーニングデータと
オレンジのテストデータの 分散を比較できます Facets Overviewでは
カテゴリ特性値も可視化できます この例で ここに表示されているのは ターゲット特性値の分析結果であり 年収$5万以上の人かどうかを
表すラベルです 特に注目したいのは 年収$5万以下である
すべてのサンプル値です このターゲット特性で1つ変な点があります トレーニングとテストの
データセットでラベル値が異なります テストセットの後続ピリオドが原因です Facets Overviewは食い違いの
並べ替えも行い 青色のトレーニングデータと
オレンジのテストデータで 非対称が最大である特性値の分散距離を
最も上に表示します このようにラベルの不一致が起きると データでトレーニング/テストしたモデルが
正しく評価されなくなります Facets Diveに移りましょう このスライドのように 直感的なUIをカスタマイズして データセットの複数の特性値にまたがる
データポイント間の関係を 簡単に調べられます Facets Diveを使用すると 特性値に基づいて 各データポイントの
位置、色、可視化表現を制御できます 具体的には この例の場合 UCI国勢調査テストデータセットの
すべてのデータポイントを示します アニメーションでは 1つの特性「関係」で
データポイントに色を付け 連続的な特性「年齢」を
1つのディメンションに結び付け 別の特性「配偶者の有無」を
別のディメンションに結び付けます Facets Diveでは データポイントに
画像が関連付けられている場合 画像を可視化表現として使用できます つまりカテゴリ特性や数値特性に
限定されるわけではありません この画像に示す例は リサーチベースの
画像データセットから得られました 画像分類トレーニング用の
世界中の物体や動物がここに含まれます 実地検証ラベルは行に配置され 予測されたラベルは列に配置されます この構成から混同行列ビューが生成され 特定の種類の分類ミスを引き出せます この例のMLモデルは 本物の猫のごく一部を 間違ってカエルとラベル付けします ここで カエルのような猫がわかりますか? 興味深いことに Facets Diveを使って
混同行列内に実際の画像を置くと モデルが「カエルだ」と予測した
本物の猫のうち1匹は 可視化検査をすると実際にカエルです Facets Diveを使用すると この分類ミスは実際に モデルの分類ミス
ではなかったと分かります 実は データセット内の特性データに
間違ったラベルが付いていたのです Facetsなどのツールは データに関する新しい発見や
興味深い発見に役立つでしょう こうしてMLモデルがもっと正確で
包括的になること期待しています