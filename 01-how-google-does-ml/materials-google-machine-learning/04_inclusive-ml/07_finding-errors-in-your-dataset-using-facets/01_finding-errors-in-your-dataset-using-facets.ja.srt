1
00:00:00,000 --> 00:00:04,565
評価指標を使ってMLモデルを
より包括的にする方法を

2
00:00:04,565 --> 00:00:06,305
すでに見ました

3
00:00:06,305 --> 00:00:11,580
でもモデルから最善の結果を得るには
データを本当に理解する必要があります

4
00:00:11,580 --> 00:00:13,350
しばしば課題となるのは

5
00:00:13,350 --> 00:00:16,865
データセットに何億もの
データポイントが含まれ

6
00:00:16,865 --> 00:00:19,845
それぞれに数百、数千もの特性がある場合です

7
00:00:19,845 --> 00:00:25,200
そうなると直感的にデータセット全体を
理解するのはほぼ不可能です

8
00:00:25,200 --> 00:00:27,180
鍵となるのは 可視化を利用して

9
00:00:27,180 --> 00:00:31,425
巨大なデータセットの微妙な意味合いや
分析情報を明らかにすることです

10
00:00:31,425 --> 00:00:32,875
このセクションでは

11
00:00:32,875 --> 00:00:36,825
Facetsというオープンソースの
データ可視化ツールを見ていきます

12
00:00:36,825 --> 00:00:38,900
FacetsはGoogleで開発され

13
00:00:38,900 --> 00:00:42,465
機械学習モデルを
より包括的にする手段の1つです

14
00:00:42,465 --> 00:00:46,180
Facetsは2つの部分
OverviewとDiveで構成されます

15
00:00:46,180 --> 00:00:49,875
このスライドはFacets Overviewの
スクリーンショットです

16
00:00:49,875 --> 00:00:53,290
データセットの複数の特性にまたがる
値の分散が

17
00:00:53,290 --> 00:00:55,560
短時間で自動的にわかります

18
00:00:55,560 --> 00:00:59,445
このスライドの例は
UCI人口調査データから得られました

19
00:00:59,445 --> 00:01:03,480
データは1994年国勢調査
データベースから抽出され

20
00:01:03,510 --> 00:01:07,050
米国の人口に関する
匿名化データが入っています

21
00:01:07,050 --> 00:01:08,580
このデータセットには

22
00:01:08,580 --> 00:01:11,750
人口動向や雇用に関連する
データが含まれています

23
00:01:11,750 --> 00:01:13,130
年齢や給与などです

24
00:01:13,130 --> 00:01:16,700
調査委員会によってまとめられた
このデータセットは

25
00:01:16,700 --> 00:01:19,880
ある人の年収が$5万以上かどうか

26
00:01:19,880 --> 00:01:22,860
予測するためのタスクによく使われます

27
00:01:22,860 --> 00:01:25,115
トレーニングセットとテストセットなど

28
00:01:25,115 --> 00:01:28,125
複数のデータセットを
同じ可視化で比較できます

29
00:01:28,125 --> 00:01:33,335
Facetsでは 機械学習を妨げる一般的な
データの問題が前面に出てきます

30
00:01:33,335 --> 00:01:35,775
たとえば 予想に反した特性値がある

31
00:01:35,775 --> 00:01:40,585
高い割合で欠落した値がある 分散に偏りがある

32
00:01:40,585 --> 00:01:43,585
データセット間で分散が非対称
といった問題です

33
00:01:43,585 --> 00:01:46,110
前のスライドと同じスクリーンショットですが

34
00:01:46,110 --> 00:01:50,210
UCI国勢調査データセットの
2つの数値特性値が示されています

35
00:01:50,210 --> 00:01:52,640
つまり資本利得と資本損失です

36
00:01:52,640 --> 00:01:55,370
特性値は 不均一性を基準に並べ替えられ

37
00:01:55,370 --> 00:01:58,270
最も不均一な分散の特性が最も上になります

38
00:01:58,270 --> 00:02:01,210
赤い数値は問題の可能性がある個所を示します

39
00:02:01,210 --> 00:02:05,865
この場合は 高い割合で
値がゼロに設定される数値特性値です

40
00:02:05,865 --> 00:02:07,860
右側のヒストグラムを見ると

41
00:02:07,860 --> 00:02:11,315
青のトレーニングデータと
オレンジのテストデータの

42
00:02:11,315 --> 00:02:12,915
分散を比較できます

43
00:02:12,915 --> 00:02:16,635
Facets Overviewでは
カテゴリ特性値も可視化できます

44
00:02:16,635 --> 00:02:19,040
この例で ここに表示されているのは

45
00:02:19,040 --> 00:02:21,480
ターゲット特性値の分析結果であり

46
00:02:21,480 --> 00:02:26,520
年収$5万以上の人かどうかを
表すラベルです

47
00:02:26,520 --> 00:02:29,010
特に注目したいのは

48
00:02:29,010 --> 00:02:33,770
年収$5万以下である
すべてのサンプル値です

49
00:02:33,770 --> 00:02:36,850
このターゲット特性で1つ変な点があります

50
00:02:36,850 --> 00:02:41,110
トレーニングとテストの
データセットでラベル値が異なります

51
00:02:41,110 --> 00:02:43,665
テストセットの後続ピリオドが原因です

52
00:02:43,665 --> 00:02:47,110
Facets Overviewは食い違いの
並べ替えも行い

53
00:02:47,110 --> 00:02:50,720
青色のトレーニングデータと
オレンジのテストデータで

54
00:02:50,720 --> 00:02:54,900
非対称が最大である特性値の分散距離を
最も上に表示します

55
00:02:54,900 --> 00:02:57,176
このようにラベルの不一致が起きると

56
00:02:57,176 --> 00:03:01,880
データでトレーニング/テストしたモデルが
正しく評価されなくなります

57
00:03:01,880 --> 00:03:03,795
Facets Diveに移りましょう

58
00:03:03,795 --> 00:03:05,245
このスライドのように

59
00:03:05,245 --> 00:03:07,255
直感的なUIをカスタマイズして

60
00:03:07,255 --> 00:03:11,400
データセットの複数の特性値にまたがる
データポイント間の関係を

61
00:03:11,400 --> 00:03:13,167
簡単に調べられます

62
00:03:13,185 --> 00:03:16,245
Facets Diveを使用すると 特性値に基づいて

63
00:03:16,245 --> 00:03:20,985
各データポイントの
位置、色、可視化表現を制御できます

64
00:03:20,985 --> 00:03:23,387
具体的には この例の場合

65
00:03:23,387 --> 00:03:28,185
UCI国勢調査テストデータセットの
すべてのデータポイントを示します

66
00:03:28,185 --> 00:03:32,850
アニメーションでは 1つの特性「関係」で
データポイントに色を付け

67
00:03:32,850 --> 00:03:36,330
連続的な特性「年齢」を
1つのディメンションに結び付け

68
00:03:36,330 --> 00:03:40,275
別の特性「配偶者の有無」を
別のディメンションに結び付けます

69
00:03:40,275 --> 00:03:44,220
Facets Diveでは データポイントに
画像が関連付けられている場合

70
00:03:44,220 --> 00:03:47,105
画像を可視化表現として使用できます

71
00:03:47,105 --> 00:03:51,590
つまりカテゴリ特性や数値特性に
限定されるわけではありません

72
00:03:51,590 --> 00:03:53,030
この画像に示す例は

73
00:03:53,030 --> 00:03:56,180
リサーチベースの
画像データセットから得られました

74
00:03:56,180 --> 00:04:00,270
画像分類トレーニング用の
世界中の物体や動物がここに含まれます

75
00:04:00,270 --> 00:04:02,235
実地検証ラベルは行に配置され

76
00:04:02,235 --> 00:04:04,605
予測されたラベルは列に配置されます

77
00:04:04,605 --> 00:04:07,565
この構成から混同行列ビューが生成され

78
00:04:07,565 --> 00:04:11,305
特定の種類の分類ミスを引き出せます

79
00:04:11,305 --> 00:04:13,400
この例のMLモデルは

80
00:04:13,400 --> 00:04:15,220
本物の猫のごく一部を

81
00:04:15,220 --> 00:04:17,670
間違ってカエルとラベル付けします

82
00:04:17,670 --> 00:04:20,285
ここで カエルのような猫がわかりますか?

83
00:04:20,285 --> 00:04:21,475
興味深いことに

84
00:04:21,475 --> 00:04:25,300
Facets Diveを使って
混同行列内に実際の画像を置くと

85
00:04:25,300 --> 00:04:29,000
モデルが「カエルだ」と予測した
本物の猫のうち1匹は

86
00:04:29,000 --> 00:04:31,735
可視化検査をすると実際にカエルです

87
00:04:31,735 --> 00:04:33,490
Facets Diveを使用すると

88
00:04:33,490 --> 00:04:38,525
この分類ミスは実際に モデルの分類ミス
ではなかったと分かります

89
00:04:38,525 --> 00:04:43,870
実は データセット内の特性データに
間違ったラベルが付いていたのです

90
00:04:43,870 --> 00:04:45,590
Facetsなどのツールは

91
00:04:45,590 --> 00:04:49,400
データに関する新しい発見や
興味深い発見に役立つでしょう

92
00:04:49,400 --> 00:04:54,530
こうしてMLモデルがもっと正確で
包括的になること期待しています