こちらは 前のコースで 包括的MLと顔認識について
説明した際に使った表です このとき 顔検出MLモデルが 人の顔でないものを
誤って人の顔だと予測した場合は 偽陽性と呼び 人の顔が冬服で隠れていたために
誤って人の顔でないと予測した場合は 偽陰性と呼ぶと説明しました このような混同行列を使用することで 分類モデルのパフォーマンスを
定量的に評価できます 4区画それぞれに数字がありますが ビジネスリーダーが求める数字は1つです どれを伝えればよいでしょうか もう少し掘り下げるため 画像分類の例をもう1つ見てみましょう 駐車スペースが空いている つまり ラベルが陽性のとき モデルの予測も空きなら 真陽性と呼びます 駐車スペースが埋まっているのに モデルの予測が空きなら 偽陽性 または 第一種過誤と呼びます モデルの陽性の予測の
パフォーマンスを比較するには 適合率という指標を使います 適合率が高ければ 空きと予測した場合に その確信度が高く 適合率が1.0なら 空きと予測した駐車スペースが実際に
すべて空いていることを意味します ただし 空きスペースを見逃した可能性もあり
これを偽陰性と呼びます 適合率は正式には 真陽性の数を陽性に分類された
データの総数で割ったものと定義されます 表を参考に何が増加すると
適合率が減少するでしょうか 答えは偽陽性です 駐車場の例では モデルが実際には空いていない
スペースを空きと予測すると 適合率が下がります 再現率と適合率は多くの場合
逆相関の関係にあります 再現率が高ければ 実際に空いている
スペースを多く見つけられます 再現率が1.0なら 空いている10か所の
スペースうちすべてを見つけたことを意味します ただし 空きと予測したスペースが
実際は埋まっていた可能性もあり これを偽陽性と呼びます 駐車場の例では再現率はいくつでしょうか 実際に空いていたスペースは10か所 モデルが空きとしたのは1か所です 答えは10分の1 つまり 0.1です こちらにいくつか画像があります 猫が写っている画像と
写っていない画像があります 猫が写っている画像はどれでしょうか すべて見つけられたでしょうか 赤で囲った部分に猫が隠れています また ここではトラは猫には分類されません では モデルによる分類を見ていきましょう こちらがモデルによる分類です 分類結果と正解を比べてみましょう 適切にラベリングされたデータポイントと
モデルによる予測を並べて表示しました モデルに入力したデータ つまり インスタンスは 全部で8つです モデルの予測が正しかったのは何回ですか 合計8回のうち正しく予測したのは3回でした したがって モデルの正解率は0.375となります 正解率は モデルのパフォーマンスを
説明する上で最適な指標でしょうか 他の指標について説明する前に よくある落とし穴について説明します 猫の画像の分類の例に戻ると モデルの適合率はどうでしょうか 5枚の画像を陽性カテゴリに分類しました このうち実際に猫が写っていたのは
何枚でしょうか 5枚中2枚なので 適合率は0.4となります 再現率とは 陽性のものはすべて
陽性と判断できることです こちらは実際に猫が写っている画像と
それに対するモデルの予測です 再現率はどうでしょうか 言い換えると 実際に猫が写っている画像のうち
モデルが正しく予測できたのは何枚ですか 実際に猫が写っている4枚のうち
正解は2枚だけなので 再現率は0.5です 最適化についてここまでに学んだことを
簡単にまとめます まず MLモデルを一連のパラメータと
ハイパーパラメータとして定義し 最適化をパラメータ領域の
探索として構成しました 次に 損失関数を取り上げました これは 学習の各ステップで
モデルのパフォーマンスを 定量的に測定し 評価する手段です 線形回帰向けのRMSEと
分類タスク向けの交差エントロピーという 2つの損失関数を例に説明しました 損失関数の傾きを分析することで 探索の方向とステップの大きさを求め 損失曲面を効率的にトラバースする方法を
学びました このプロセスは勾配降下法と呼ばれます TensorFlow Playgroundを使って
さまざまなMLモデルを構成し 線形モデルでも 非線形の特徴量によって 非線形の関係を学習できることと NNが特徴量の階層を
学習する仕組みを説明しました また 学習率やバッチサイズなどの
ハイパーパラメータが 勾配降下法に与える影響についても
説明しました 続いて 問題に応じて
分類モデルのパフォーマンス指標を 正解率、適合率、再現率の中から
選択する方法を説明しました このモジュールで見てきたように ラベリングされた学習データセットは
モデルの学習の原動力です 次のモジュールでは データセット全体を効果的に
学習と評価に分割する方法と 注意すべき落とし穴を取り上げます