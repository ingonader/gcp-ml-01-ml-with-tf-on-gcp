赤ちゃんは尊い存在です 生まれた後すぐに緊急処置が
必要になる赤ちゃんもいます しかし こうした処置ができる
専門の医師の数は多くありません 処置を必要としている赤ちゃんのところに ピンポイントで医師を派遣できれば一番ですが 現実はそうはいきません これはどのようなML課題になるでしょうか もし 生まれる前に処置が
必要なことがわかっていれば 赤ちゃんの処置を行うため
医師を待機させることができます 生まれる前に予測を立てる場合 このモデルの特徴量となりうるのは
次のどれでしょうか 母親の年齢、出生時間、赤ちゃんの体重 同じく 生まれる前に予測を立てる場合 このモデルのラベルとなりうるのは
次のどれでしょうか 母親の年齢、出生時間、赤ちゃんの体重 この質問への答えがわからなくても
かまいません このような質問の多くは
非常に専門的だからです しかし 直観的にわかる部分もあります 予測の時点から見てどのタイミングで
情報が手に入るかという点です 出生時刻は赤ちゃんが
生まれるまでわかりません ですから 予測には使用できません 体重も赤ちゃんの健康状態を示す
重要な指標です 母親の年齢は観測可能なので
そこから赤ちゃんの体重を予測できます これは ML課題に適したケースのようです 理由は 赤ちゃんの健康を把握しておく
明らかな必要性があり それが事前に予測可能だと考えられるからです 赤ちゃんの体重をラベルに選んだとすると どのようなML課題になるでしょうか ヒントは 赤ちゃんの体重は
連続数だということです ここでは 回帰問題として扱いましょう 単純にするために 特徴量として母親の年齢を
ラベルとして赤ちゃんの体重のみを考慮します データにはアメリカ政府が収集した 出生データセットと呼ばれる
データセットを使用します BigQueryで使用できる
一般公開データセットです 多くの場合 データをモデル化する際の
最初のステップは ノイズではないシグナルが存在する
ことを検証するためのデータ確認です これは 赤ちゃんの体重を 母親の年齢の
関数として示した散布図です 通常 散布図は大規模なデータセットの
全データではなく 標本から作成します なぜでしょうか 1つ目の理由は 膨大なデータを
プロットすることが計算上不可能だから 2つ目は 膨大なデータを使用すると
散布図を読み取ることが難しいからです 母親の年齢と赤ちゃんの体重の間には
わずかな正の関係があるようです 先ほどと同じ2つの変数を使った
別のグラフをお見せします データを個々に表示する散布図とは違い このグラフは データの集まり
具体的には分位数を表しています このため グラフの作成前に
標本抽出を行う必要がなく 代表的な標本でないものが
含まれるリスクはありません さらに 結果は再現可能で プロセスは並列処理できます このグラフは私が作ったもので
約22GBのデータをわずか数秒で処理します こうしたグラフの作成方法は 後ほど説明します データを見て何か関係性が読み取れますか 散布図からはわからなかったことに
気付いたかもしれません 赤ちゃんの体重は母親の年齢が
30歳前後のときに最大となります 30歳より上および下になると
体重は徐々に減少していて 非線形の関係を示唆しています これらは両方とも散布図では
わからなかったことであり この関係を線形モデルで
モデル化しようとしているので 不穏な兆しでもあります 実は 非線形関数を線形モデルで
モデル化しようすることは 未学習と呼ばれる例です なぜもっと複雑なタイプのモデルではないのかと
思うかもしれませんが 学習上の理由から使用しません 後ほど モデルの選択と
過学習と呼ばれる概念について説明します 簡単に言うと モデルの複雑性に比例して
高まるリスクがあるということです 母親の年齢と赤ちゃんの体重の間には
わずかな正の関係があると思われます これを直線でモデル化します 線形モデルを使用すると 先ほどの直観から 正のy切片を持つ上向きの
直線になると考えられます データから見当をつけて
この直線を選択しましたが もっと上がよいのか 下がよいのか 正しい位置に線が引けているのか 他の直線より優れた線なのかは
どうすればわかるのでしょうか 統計学を学んだことがある方は
覚えているかもしれませんが 最小二乗回帰と呼ばれる直線の最適な
重みを求める方法があります また 線形モデルの最適な重みを
解析的に求める方法もあります 問題なのは こうした解決策が 
一定の規模を超えると機能しない点です 使用するデータセットが大規模になると 問題を解析的に処理するのに必要な
演算が実行困難になります 解析による解決ができない場合
どうすればよいのでしょうか 勾配下降法を使います 最適化をパラメータ領域の探索と
考えるところから始めましょう この単純な線形モデルには
2つのパラメータがあります 重み項とバイアス項です これらは両方とも実数値なので
2つのパラメータの値のすべての組み合わせを 2次元領域内の点と考えることができます ただし 求めるのは最適値です パラメータ領域のある点と別の点は
質的にどう違うのでしょうか まず 質問の仕方を少し変える必要があります 多くの場合 データが存在する領域である
入力領域自体が無限であるため 入力領域のすべてのポイントで
パラメータを評価することは不可能です このため 通常は手元にある
トレーニングデータを基に この計算結果を推測します そのためには あるデータポイントの予測の質 つまりは その予測の誤差を 一連の予測の質を示す数へと
汎化する必要があります そのための関数を損失関数と呼びます