前のコースでは特徴クロスとともに
埋め込みについて簡単に学習しましたが 埋め込みは近代的な機械学習の
至るところで利用されており 特徴クロスや
構造化データばかりではありません 埋め込みは画像モデルやテキストモデルでも
頻繁に利用されています では埋め込みについて
簡単に復習してみましょう まず一例として 交通関連の予測を行う
機械学習モデルを作成しました たとえば次の車が
交差点に着くまでの間の さまざまな情報をモデルに
入力するとします 特に時刻や曜日などという
カテゴリ情報に注目します ここで時刻や曜日を
単独の情報として扱わず 連結して特徴クロスを
作成すると 機械学習モデルは大幅に
改善されると説明しました この特徴クロスの際に
多数のハッシュバケットを使用すれば それぞれのバケットにはおそらく 時刻と曜日の組み合わせが1つだけ
含まれることになります ここで埋め込みの概念を
紹介しました 特徴クロスを
ワンホットエンコードして そのまま利用する代わりに 結合層に渡して交通を予測するよう
モデルをトレーニングします この黄色と緑のノードで示された結合層で
埋め込みが作成されます 埋め込みは実数値になります 特徴クロスの値の
加重和だからです ここで重要なのは この黄色と緑のノードで示された
埋め込み層に加わる重みが データから学習されるということです 要点はこうした重みを
データセットでトレーニングして 現実的な問題を解決すると
非常に有効だということです 曜日と時間の
特徴クロスには 68の固有値が含まれますが ここではそれらをたった2つの
実数値で表しているのです このモデルは特徴クロスを
低次元領域に埋め込む方法を学習します この緑のボックスはおそらく
歩行者の通行をとらえており 黄色のほうは自動車の通行を
表すと考えられますが これらが厳密に何をとらえているかは
問題ではありません 重要なのはその時刻や曜日における
街中の交差点での 交通に関連するすべての情報が たった2つの数値に凝縮されている
ということです これを大規模で高品質な
データセットに対して行えば これらの数値は1つの
非常に有用な特性を持つことになります 交通状態が似ている時間に対しては 近似した実数値が与えられ 交通状態が異なる時間に対しては
異なる実数値が与えられます 次にTensorFlowでの埋め込みの
作成方法を紹介しました 埋め込みを作成するには tf.feature列で埋め込み列の
メソッドを使用して 埋め込むカテゴリの列を渡します これは特徴クロスだけでなく あらゆるカテゴリ列に使用できます あらゆるカテゴリ列を
埋め込めるのです そして最後に
ある問題で学習した埋め込みを 別の類似した機械学習の問題に
適用する方法を簡単に説明しました たとえばロンドンの
交通データを利用して 時刻や曜日を2つの実数値で
表す方法を学んだなら 同じ重みを簡単に別の都市にも
適用してみることができます また 交通の問題で学習した
埋め込みを利用して TV番組の視聴率を
予測することもできます これは道路の交通量と
TV番組の視聴率が いずれも同じ潜在的因子に
依存しているからです つまり人々が移動中か
家庭と職場のどちらにいるかということです 一見まったく異なる問題でも
同じ潜在的因子を共有していれば 転移学習を利用できることがあります