tf.expand_dimsは tensorに1つの次元を挿入して
形状を変更します 3行2列の行列xがあります xでtf.expand_dimsを
呼び出す際 どの次元に挿入するかを指定します ここでは Pythonの
2次元目を指定します 0が1次元目です 形状が (3, 2) から (3, 1, 2) に 拡張されました どういうことでしょうか 3行2列の行列だったxの値が 3次元行列 つまり
3次元テンソルになりました 左角かっこの数が変わっています 保存されている数値は変わりません ここではスライスを使って テンソルの一部を抽出します 以前は 角かっこと
抽出する行/列を指定する 省略形の構文でしたが 今回は省略形のないtf.sliceで xからデータを抜き出します [0, 1]から開始して 2行1列のデータを取り出します 2と5を得られる理由がわかりますか ここで問題です このtf.sliceを 角かっこ付きの
構文にするとどうなりますか 答えは まずx[ 必要な行は0:2
必要な列は1:2 正解はx[0:2, 1:2]です squeezeは
expand_dimsの逆の演算です expand_dimsでは サイズ1の次元を
テンソルのどこにでも挿入できます squeezeではサイズ1の次元を
テンソルの形状から削除できます このテンソル「t」は 角かっこの数からわかるとおり 3次元テンソルです tを渡して squeezeを呼び出すと
コンパクトな2次元テンソルが得られます 元のテンソルは1, 2, 4
削除後は 2, 4 です ここではreshapeを使えば 済みますが 1次元を挿入するか削除するか
明らかにすることで わかりやすいコードになります 変換には基本的に 1/2/4の行列を
コンテキストに応じて 形状1, 2, 4の3次元テンソルか 形状2, 4の
2次元テンソルとして扱います